### 变量对象



#### 前言

js代码执行一段可执行代码时，会创建对应的执行上下文。

* 变量对象
* 作用域链
* this



不同执行上下文中的变量对象稍有不同，全局上下文的变量对象和函数上下文下的变量对象。



#### 全局上下文 

**全局上下文中的变量对象就是全局对象**

可以通过this引用 在客户端js中 全局对象就是Window对象。全局对象是由Object 构造函数实例化的一个对象

```javascript
this instanceof Object;
```





#### 函数上下文

函数上下文中。用活动对象（activation object, AO）来表示变量对象。



**一个执行上下文的生命周期可以分为两个阶段。**

1、创建阶段

> 在这个阶段中 执行上下文会分别创建变量对象 建立作用域链 以及确定this的指向

2、代码执行阶段

> 创建完成之后 就会开始执行代码 这个时候会完成变量赋值 函数引用 以及执行其他代码



**未进入执行阶段之前 变量对象VO中的属性都不能访问。但是进入执行阶段之后。变量对象VO变成了活动对象AO 里面的属性都能被访问了 然后 开始执行阶段的操作。其实都是同一个对象 只是出于执行上下文的不同生命周期**





#### 执行过程

执行上下文的代码会分为两个阶段处理。 分析和执行 

1、进入执行上下文

2、代码执行



#### 进入执行上下文

进入执行上下文时，这时候还没执行代码

变量对象会包括:

1、函数的所有形参( 如果是函数上下文 )

* 由名称和对应值组成的一个变量对象的属性被创建
* 没有实参 属性值都是undefined

2、函数声明

* 由名称和对应值 组成一个变量对象的属性被创建
* 如果变量对象已经存在相同的名称属性 则完全替换这个属性

3、变量声明

* 由名称和对应值组成一个变量对象的属性被创建
* 如果变量名称跟已经声明的形式参数或函数相同 则变量声明不会干扰已经存在的这类属性